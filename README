Code for functional STN project